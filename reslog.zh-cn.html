<?xml version="1.0" encoding="GB2312" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-cn">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=GB2312" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="Content-Script-Type" content="text/javascript" />
<meta name="author" content="依玛猫" />
<meta name="copyright" content="&copy; 2001-2005 依玛猫。依玛猫保有所有权利。" />
<meta name="keywords" content="DNS 反查, HostNameLookups, Apache, Analog, 记录档" />
<link rel="alternate" type="application/xhtml+xml" href="reslog.zh-tw.html"
     hreflang="zh-tw" title="正&#39636;中文" />
<link rel="alternate" type="application/xhtml+xml" href="reslog.en.html"
     hreflang="en-us" title="English" />
<title>reslog 3.05 版</title>
</head>
<body>

<address>
    <span xml:lang="zh-tw"><a href="reslog.zh-tw.html"
        title="切&#25563;到本&#38913;的正&#39636;中文版。"
        hreflang="zh-tw">正&#39636;中文</a></span> |
    <span>简体中文</span> |
    <span xml:lang="en-us"><a href="reslog.en.html"
        title="Switch to the English version of this page."
        hreflang="en-us">English</a></span>
</address>
<hr />


<h1><samp>reslog</samp> 3.05 版</h1>


<div class="body">

<h2>最新消息</h2>

<dl>

<dt>2005-05-08</dt>

<dd><samp>reslog</samp> 最新版本 3.05 。修正 <samp>STDIN</samp> 不可用时会产生错误的问题。<a href="ftp://ftp.imacat.idv.tw/pub/reslog/reslog-3.05.tar.gz" type="application/x-gzip">下载 <samp>reslog</samp> 3.05 版</a>。</dd>


<dt>2005-05-08</dt>

<dd><samp>reslog</samp> 最新版本 3.04 。修正载入 <samp>File::MMagic</samp>
 时的别字。<a href="ftp://ftp.imacat.idv.tw/pub/reslog/reslog-3.04.tar.gz" type="application/x-gzip">下载 <samp>reslog</samp> 3.04 版</a>。</dd>


<dt>2005-05-08</dt>

<dd><samp>reslog</samp> 最新版本 3.03 。预设安装目录改回到 <samp>/sbin</samp> ，加上 <samp>make upgrade</samp> 以删除旧版档案，并解决了之前档案锁定方法不一的问题。<a href="ftp://ftp.imacat.idv.tw/pub/reslog/reslog-3.03.tar.gz" type="application/x-gzip">下载 <samp>reslog</samp> 3.03 版</a>。</dd>


<dt>2005-05-02</dt>

<dd><samp>reslog</samp> 最新版本 3.02 。反查程式现在与主程式互相独立，在 <samp>MSWin32</samp> 与 <samp>cygwin</samp> 上测试执行无误，并解决了好几个小问题。<a href="ftp://ftp.imacat.idv.tw/pub/reslog/reslog-3.02.tar.gz" type="application/x-gzip">下载 <samp>reslog</samp> 3.02 版</a>。</dd>


<dt>2005-04-26</dt>

<dd><samp>reslog</samp> 最新版本 3.01 。修正了一个严重的错误，错使 <samp>--suffix</samp> 与 <samp>--trim-suffix</samp> 处理了错误的档尾。若你下载安装了 3.01 版，请立即升级更新。<a href="ftp://ftp.imacat.idv.tw/pub/reslog/reslog-3.01.tar.gz" type="application/x-gzip">下载 <samp>reslog</samp> 3.01 版</a>。</dd>


<dt>2005-04-26</dt>

<dd><samp>reslog</samp> 最新版本 3.00 。我用物件导向模式，从头重写。新加上 ithreads 多线程功能，大幅加快执行速度。支援 bzip2 压缩档。支援用 <samp>gzip</samp> 或 <samp>bzip2</samp> 程式解压缩，不需安装 <samp>Compress::Zlib</samp> 和 <samp>Compress::Bzip2</samp> 模组（不建议使用）。可先裁掉某些档尾，再加上我们的档尾，以便和其他记录档处理程式一起作业。<a href="ftp://ftp.imacat.idv.tw/pub/reslog/reslog-3.00.tar.gz" type="application/x-gzip">下载 <samp>reslog</samp> 3.00 版</a>。</dd>


<dt>2002-09-18</dt>

<dd><samp>reslog.pl</samp> 最新版本 2.1.0dev2 。本版修正了几个说明文件的错误，并把 <a href="http://sourceforge.net/" hreflang="en">SourceForge</a> 加进 <samp>reslog.pl</samp> 的下载网址中。你可以把它当做<q>SourceForge 纪念版</q>。原则上，不需要急著升级。<a href="ftp://ftp.imacat.idv.tw/pub/reslog/reslog.pl-2.1.0dev2.tar.gz" type="application/x-gzip">下载 <samp>reslog.pl</samp> 2.1.0dev2 版</a>。</dd>


<dt>2002-09-17</dt>

<dd>好消息！ <samp>reslog.pl</samp> 已开始架设於 <a href="http://sourceforge.net/projects/reslog/" hreflang="en">SourceForge</a> 罗！（虽然我几乎还完全搞不清楚要怎么架……摸索中…… ^^; ）</dd>


<dt>2002-08-31</dt>

<dd><samp>reslog.pl</samp> 最新版本 2.1.0dev1 。本版修正了无法在 <acronym title="Practical Extraction and Reporting Language">Perl</acronym> 5.8.0 执行的错误。我暂时还把她当成是<q>dev</q>研发版，因为我想在 2.1.0 正式版的时候，支援 <a href="http://search.cpan.org/dist/Compress-Bzip2/" hreflang="en"><samp>Compress::Bzip2</samp></a> 与 <a href="http://search.cpan.org/dist/ExtUtils-MakeMaker/" hreflang="en"><samp>ExtUtils::MakeMaker</samp></a> 。不过她其实很稳定。<a href="ftp://ftp.imacat.idv.tw/pub/reslog/reslog.pl-2.1.0dev1.tar.gz" type="application/x-gzip">下载 <samp>reslog.pl</samp> 2.1.0dev2 版</a>。</dd>

</dl>


<h2>说明</h2>

<p><samp>reslog</samp> 是记录档的反查程式，用来反查 <a href="http://httpd.apache.org/" hreflang="en">Apache</a> 记录档里 <abbr>IP</abbr> 的主机名称。查过后，可以套用像 <a href="http://analog.cx/" hreflang="en">Analog</a> 之类的记录档统计程式。你可以把它当做 Apache <samp>HostNameLookups</samp> 指令的替代品，每天一次反查当天所有的 <abbr>IP</abbr> 。</p>


<h2>注意事项</h2>

<ul>

<li>反查网域名称<em>很耗时间</em>。时间主要耗在查询上：防火墙过滤网路封包，网域名称伺服器设错、没有开机、位在慢速网路上、等级太低反应慢、网路塞车……等。这些外部因素，都不是程式本身能控制的。</li>

<li>若程式半途中断，如按了 <samp>Ctrl-Break</samp> ，可能会残余一个暂时工作档。下次执行时碰到残存的暂时工作档，程式会拒绝执行跳出。请先处理残存的暂时工作档。你可以把暂时工作档当成原来的记录档来用，重新反查。</li>

<li>本程式需要很多暂存资料的空间。硬碟和记忆体比起来，价格便宜，用起来也比较省，所以我用硬碟暂存。这个程式需要原记录档两倍以上的硬碟空间，才能执行（用记忆体暂存的话要用十倍）。请检查硬碟空间够不够。</li>

</ul>


<h2>系统需求</h2>

<ol>

<li><acronym title="Practical Extraction and Reporting Language">Perl</acronym> 5.8.0 以上。新版的 <samp>reslog</samp> 用多线程加速反查，要用到 <acronym title="Practical Extraction and Reporting Language">Perl</acronym> 5.8.0 之后的新 ithread 多线程模式。你若不想用多线程功能，可以不用，不过程式码本身，还是要用到 ithread 。若你用的是 5.8.0 以前的 <acronym title="Practical Extraction and Reporting Language">Perl</acronym> 版本，请升级你的 <acronym title="Practical Extraction and Reporting Language">Perl</acronym> 。你可以输入 <samp>perl -v</samp> 查询你目前的 Perl 版本。如果你没有 <acronym title="Practical Extraction and Reporting Language">Perl</acronym> 或需要升级，可以到 <a href="http://www.perl.com/" hreflang="en"><acronym title="Practical Extraction and Reporting Language">Perl</acronym> 网站</a>下载安装最新版 <acronym title="Practical Extraction and Reporting Language">Perl</acronym> 。若你是用 MSWin32 ，可以到 <a href="http://www.activestate.com/" hreflang="en">ActiveState 公司</a>下载 ActivePerl 安装。</li>

<li>需搭配的 <acronym title="Practical Extraction and Reporting Language">Perl</acronym> 模组：无。</li>

<li>选配的 <acronym title="Practical Extraction and Reporting Language">Perl</acronym> 模组：

<dl>
<dt><a href="http://search.cpan.org/dist/File-MMagic/" hreflang="en"><samp>File::MMagic</samp></a></dt>

<dd>这是检查档案类型用的。若没有安装， <samp>reslog</samp> 会试著去找 <samp>file</samp> 程式代替。若还找不到， <samp>reslog</samp> 会改用档尾（副档名）判断档案类型。这时若从标准输入读档， <samp>reslog</samp> 会无法判断。  MSWin32 使用者可以由 <a href="http://gnuwin32.sourceforge.net/" hreflang="en-us">GnuWin32 网站</a>下载 <samp>file.exe</samp> 程式。请确认下载后，存档在系统的路径下，档名为 <samp>file.exe</samp> 。</dd>

<dt><a href="http://search.cpan.org/dist/Compress-Zlib/" hreflang="en"><samp>Compress::Zlib</samp></a></dt>

<dd>这是处理 gzip 压缩档用的，只有在处理 gzip 压缩档才会用到。若要用时没有安装， <samp>reslog</samp> 会试著改用 <samp>gzip</samp> 程式代替。若还找不到， <samp>reslog</samp> 就无法执行。若你是 ActivePerl MSWin32 使用者，可以用 <samp>ppm install Compress::Zlib</samp> 安装，或由 <a href="http://www.gzip.org/" hreflang="en">gzip 网站</a>下载 <samp>gzip.exe</samp>。请确认下载后，存档在系统的路径下，档名为 <samp>gzip.exe</samp> 。</dd>

<dt><a href="http://search.cpan.org/dist/Compress-Bzip2/" hreflang="en"><samp>Compress::Bzip2</samp></a> 第二版以上</dt>

<dd>这是处理 bzip2 压缩档用的，只有在处理 bzip2 压缩档才会用到。若要 用时没有安装， <samp>reslog</samp> 会试著改用 <samp>bzip2</samp> 程式代替。若还找不到， <samp>reslog</samp> 就无法执行。到我写这一篇说明的时候为止， ActivePerl MSWin32 的 <abbr title="Programmer's Package Manager">PPM</abbr> 模组库里都还没有 <samp>Compress::Bzip2</samp> 。不过 MSWin32 的使用者还是可以由 <a href="http://sources.redhat.com/bzip2/" hreflang="en">bzip2 网站</a> 下载 <samp>bzip2.exe</samp> 。请确认下载后，存档在系统的路径下，档名为 <samp>bzip2.exe</samp> 。</dd>

<dt><a href="http://search.cpan.org/dist/Term-Size/" hreflang="en"><samp>Term::Size</samp></a></dt>

<dd>这是显示进度列用的，若没有安装，就不会显示进度列。此外不会有任何问题。进度列可以让你对 <samp>reslog</samp> 的工作进度一目了然。 <samp>Term::Size</samp> 只能在 UNIX 下安装，在 MSWin32 下， reslog 会改用 <a href="http://search.cpan.org/dist/libwin32/" hreflang="en"><samp>Win32::Console</samp></a> 。</dd>
</dl>

若没有上列 <acronym title="Practical Extraction and Reporting Language">Perl</acronym> 模组，请到 <a href="http://search.cpan.org/" hreflang="en"><abbr title="Comprehensive Perl Archive Network">CPAN</abbr> 程式库</a> 下载安装。</li>
</ol>


<h2>下载</h2>

<p><samp>reslog</samp> 的官方网站在：</p>

<ul>
<li><a href="http://reslog.sourceforge.net/">SourceForge 上的 <samp>reslog</samp> 网站。</a></li>

<li><a href="https://sourceforge.net/projects/reslog/" hreflang="en"><samp>reslog</samp> SourceForge 专案页。</a></li>

<li><a href="http://search.cpan.org/~imacat/reslog/" hreflang="en"><samp>reslog</samp> <abbr title="Comprehensive Perl Archive Network">CPAN</abbr> 专案页。</a></li>

<li><a href="http://www.imacat.idv.tw/tech/reslog.html">旅舍依玛 <samp>reslog</samp> 网页</a></li>
</ul>

<p>最新版 <samp>reslog</samp> 可由下列位址下载：</p>

<ul>
<li><a href="https://sourceforge.net/project/showfiles.php?group_id=62500" hreflang="en"><samp>reslog</samp> SourceForge 下载页。</a></li>

<li><a href="http://search.cpan.org/~imacat/reslog/" hreflang="en"><samp>reslog</samp> <abbr title="Comprehensive Perl Archive Network">CPAN</abbr> 专案页。</a></li>

<li><a href="ftp://ftp.imacat.idv.tw/pub/reslog/">旅舍依玛 <abbr title="File Transfer Protocol">FTP</abbr> 站。</a></li>
</ul>

<p>依玛猫的 <abbr title="Pretty Good Privacy">PGP</abbr> 公钥在：</p>

<ul>
<li><a href="http://reslog.sourceforge.net/pgpkey.asc"><samp>reslog</samp> SourceForge 网站上的依玛猫 <abbr title="Pretty Good Privacy">PGP</abbr> 公钥。</a></li>

<li><a href="http://www.imacat.idv.tw/me/pgpkey.asc">旅舍依玛上的依玛猫 <abbr title="Pretty Good Privacy">PGP</abbr> 公钥。</a></li>
</ul>


<h2>安装</h2>


<p>其实， <samp>reslog</samp> 根本不用安装。直接跑就是了。 ^_*'</p>

<p>好吧，如果你不给它安装个一下，就会辗转难眠的话，那就请看以下的安装指南吧。再次强调，你可以不用看以下的安装指南。直接跑就是了。</p>

<p>从第三版起， <samp>reslog</samp> 改用 <acronym title="Practical Extraction and Reporting Language">Perl</acronym> 标准的 <a href="http://search.cpan.org/dist/ExtUtils-MakeMaker/" hreflang="en"><samp>ExtUtils::MakeMaker</samp></a> 安装，程序如下：</p>

<blockquote><pre>
% perl Makefile.PL
% make
% make test
% make install
</pre></blockquote>

<p>在 <samp>make install</samp> 前，请先确认你有在安装目录存档的权限。通常这时后都要切到 <samp>root</samp> ，才能安装存档。</p>

<p>如果你是用 MSWin32 下的 ActivePerl ， <samp>make</samp> 请改用 <samp>nmake</samp> 。 <a href="ftp://ftp.microsoft.com/Softlib/MSLFILES/nmake15.exe" type="application/x-dosexec"><samp>nmake</samp> 可由微软的 <abbr title="File Transfer Protocol">FTP</abbr> 站下载。</a></p>

<p>若要安装到其它地方，请设定好 <samp>PREFIX</samp> 。例如，一个一般使用者，要安装在自己的目录下时：</p>

<blockquote><pre>
% perl Makefile.PL PREFIX=/home/jessica
</pre></blockquote>

<p>要知道更多安装选项的细节，请参阅 <samp>ExtUtils::MakeMaker</samp> 的说明（请执行 <samp>perldoc ExtUtils::MakeMaker</samp> ）。</p>

<p>若你是由 <samp>reslog.pl</samp> 3.02 以前的版本升级，请参阅 <samp>UPGRADE.zh-cn</samp> 档的升级说明。</p>


<h2>命令列参数</h2>

<pre>
./reslog [参数] [记录档...]
./reslog [-h|-v]
</pre>


<dl>
<dt><var>记录档</var></dt>

<dd>要反查的记录档。若没有指定，会从标准输入读记录档，再写到标准输出。你也可以设定成<q><samp>-</samp></q>，来从标准输入读记录档。可同时指定好几个档案，若其中有标准输入，会通通写到标准输出。支援 gzip 或 bzip2 压缩档。</dd>


<dt>-o, --override=<var>模式</var></dt>

<dd>如果有同名的反查结果档，该怎么办。目前有下列模式：


<dl>
<dt>o, overwrite</dt>

<dd>盖掉旧档。</dd>


<dt>a, append</dt>

<dd>和旧档加在一起。</dd>


<dt>f, fail</dt>

<dd>结束程式，以免不小心破坏旧档。预设是结束程式。</dd>
</dl>
</dd>


<dt>-k, --keep=<var>模式</var></dt>

<dd>原记录档要怎么处理。目前有下列模式：


<dl>
<dt>a, all</dt>

<dd>保留原档。</dd>


<dt>r, restart</dt>

<dd>反查后，原记录档归零。预设是原记录档归零。</dd>


<dt>d, delete</dt>

<dd>反查后，删除原记录档。</dd>
</dl>
</dd>


<dt>-s, --suffix=<var>档尾</var></dt>

<dd>反查结果档要加上的档尾。预设的档尾是<q><samp>.resolved</samp></q>。</dd>


<dt>-t, --trim-suffix=<var>档尾</var></dt>

<dd>加上我们的档尾前，先去掉的原档档尾。预设是不去档尾。若你用好几个记录档处理程式处理记录档，可以用这个选项，去掉之前程式加的档尾。</dd>


<dt>-n, --num-threads=<var>线程数</var></dt>

<dd>反查时，同时执行的线程数。预设值是 10 。若不要用多线程反查，请设为 0 。系统本身要支援多线程。若系统本身不支援多线程，本选项没有作用。</dd>


<dt>-c, --stdout</dt>

<dd>把结果输出到标准输出。</dd>


<dt>-d, --debug</dt>

<dd>显示详细的执行过程。</dd>


<dt>-q, --quiet</dt>

<dd>没事不要吵。 :p</dd>


<dt>-h, --help</dt>

<dd>显示程式说明。</dd>


<dt>-v, --version</dt>

<dd>显示程式版本。</dd>
</dl>


<h2>版权声明</h2>

<p>版权所有 &copy; 2001-2005 依玛猫。依玛猫保有所有权利。</p>

<p>本程式是自由软体，您可以遵照自由软体基金会 (Free Software Foundation) 出版的 <cite><acronym title="GNU's Not UNIX">GNU</acronym> 通用公共许可证</cite>条款 (<cite><acronym title="GNU's Not UNIX">GNU</acronym> General Public License</cite>) 第二版来修改和重新发布这一程式，或者自由选择使用任何更新的版本。</p>

<p>发布这一程式的目的是希望它有用，但没有任何担保。甚至没有适合特定目的而隐含的担保。更详细的情况请参阅 <cite><acronym title="GNU's Not UNIX">GNU</acronym> 通用公共许可证</cite>。</p>

<p>您应该已经和程式一起收到一份 <cite><acronym title="GNU's Not UNIX">GNU</acronym> 通用公共许可证</cite>的副本。如果还没有，写信给： Free Software Foundation, Inc., 59 Temple Place - Suite 330, Boston, <abbr title="Massachusetts">MA</abbr> 02111-1307, <abbr title="United States of America">USA</abbr>.</p>


<h2>版本纪录</h2>

<p>请阅读 <samp>Changes</samp> 档，查看程式的演变、新增的功能和修补的错误。</p>


<h2>错误回报</h2>

<p><samp>reslog</samp> 有一个<a href="https://lists.sourceforge.net/lists/listinfo/reslog-users" hreflang="en">邮件通讯 <samp>reslog-users@lists.sourceforge.net</samp></a> ，若有任何问题、建议、问题回报、修补程式，请寄到邮件通讯上。除非有私人事务，否则请不要直接写信给我。邮件通讯会自动归档，日后若其他人有相同问题，可以直接在通讯旧档中找到答案，节省大家宝贵的时间。</p>


</div>

<address>依玛猫 &lt;<a href="mailto:imacat@mail.imacat.idv.tw">imacat@mail.imacat.idv.tw</a>&gt; 初稿 2001-07-04 ，上次更新日期 2005-05-08</address>


<hr />
<div>
<a href="http://validator.w3.org/check/referer"
    title="本页的 HTML 验证结果" hreflang="en"><img
    src="http://www.w3.org/Icons/valid-xhtml11" alt="XHTML 1.1 正确！" /></a>|<a
    href="http://jigsaw.w3.org/css-validator/check/referer"
    title="本页的 CSS 验证结果" hreflang="en"><img
    src="http://jigsaw.w3.org/css-validator/images/vcss" alt="CSS 正确！" /></a>|<a
    href="http://www.w3.org/WAI/wcag1AAA-Conformance"
    title="无障碍三 A 级标准说明" hreflang="en"><img
    src="http://www.w3.org/WAI/wcag1AAA"
    alt="W3C 无障碍网页规范 1.0 三 A 级标准标章" /></a>
<p>本页符合 <a href="http://www.w3.org/TR/xhtml11/" hreflang="en"><abbr
    title="Extensible HyperText Markup Language">XHTML</abbr> 1.1</a> /
    <a href="http://www.w3.org/TR/CSS21/" hreflang="en"><abbr
    title="Cascading Style Sheets">CSS</abbr> 2.1</a> /
    <a href="http://www.w3.org/TR/WAI-WEBCONTENT/"
    hreflang="en">无障碍网页规范 1.0</a> 三 A 级标准</p>
</div>

</body>
</html>
